{% comment %}
Menu template specifically for iframe embedding in Discourse.
Removes the Forum link to prevent navigation loops and double headers.
{% endcomment %}
{% load static %}
<nav class="navbar navbar-dark font-weight-bold navbar-expand-md">
  <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#menu-content"
    aria-controls="menu-content" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <a class="navbar-brand" href="/" target="_top">
    <div class="media">
      <img class="d-flex navbar-brand-logo mx-3" src="{% static "website/images/evennia_logo.png" %}"
        alt="{{game_name}} logo" />
      <div class="media-body">
        {{ game_name }}<br />
        <small>{{game_slogan}}</small>
      </div>
    </div>
  </a>

  <div class="collapse navbar-collapse" id="menu-content">
    <ul class="navbar-nav">
      {% block navbar_left %}
      <li>
        <a class="nav-link" href="{% url 'index' %}" target="_top">Home</a>
      </li>
      <!-- game views -->
      <li><a class="nav-link" href="{% url 'help' %}" target="_top">Help</a></li>
      <!-- Forum link removed in iframe context - user is already on forum -->
      <!-- end game views -->

      {% if webclient_enabled %}
      <li><a class="nav-link" href="{% url 'webclient:index' %}" target="_top">Play Online</a></li>
      {% endif %}

      {% if user.is_staff %}
      <li><a class="nav-link" href="{% url 'characters' %}" target="_top">Characters</a></li>
      <li><a class="nav-link" href="{% url 'channels' %}" target="_top">Channels</a></li>
      <li><a class="nav-link" href="{% url 'admin:index' %}" target="_top">Admin</a></li>
      {% if rest_api_enabled %}
      <li><a class="nav-link" href="/api" target="_top">API</a></li>
      {% endif %}
      {% endif %}
      {% endblock %}
    </ul>
    <ul class="nav navbar-nav ml-auto w-120 justify-content-end">
      {% block navbar_right %}
      {% endblock %}

      {% block navbar_user %}
      {% if account %}
      <li class="nav-item">
        <span class="nav-link">Logged in as {{ account.username }}</span>
      </li>
      <li>
        <form method="post" action="{% url 'logout' %}" target="_top" style="display:inline;">
          {% csrf_token %}
          <button type="submit" class="nav-link btn btn-link">Log Out</button>
        </form>
      </li>
      {% else %}
      <li>
        <a class="nav-link" href="{% url 'login' %}?next={{ request.path }}" target="_top">Log In</a>
      </li>
      {% if register_enabled %}
      <li>
        <a class="nav-link" href="{% url 'register' %}" target="_top">Register</a>
      </li>
      {% endif %}
      {% endif %}
      {% endblock %}
    </ul>
  </div>
</nav>
